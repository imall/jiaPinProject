"use strict";(self["webpackChunkbos_designer"]=self["webpackChunkbos_designer"]||[]).push([[339],{6066:function(t,e,s){s.r(e),s.d(e,{default:function(){return p}});var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"box-border h-full min-h-[calc(100vh-84px)] w-full pb-[84px]"},[s("C-Back-Nav",{attrs:{title:"行事曆",routeTarget:{name:"ScheduleBreak"}}}),t.resultItem?s("section",{staticClass:"relative z-0 mt-[52px] p-3"},[s("div",{staticClass:"m-auto mt-4 max-w-[475px] rounded-lg p-2 text-left shadow-[0_4px_10px_3px_rgba(0,0,0,0.1)]"},[s("p",{staticClass:"mb-2 text-center text-lg font-semibold"},[t._v(t._s(t.$route.query.isReview?"預約內容":"預約明細"))]),s("div",{staticClass:"mb-2 flex items-center border-b border-solid border-primary/5 pb-1"},[s("p",{staticClass:"w-1/3 font-bold"},[t._v("預約時間:")]),s("p",{staticClass:"w-1/3"},[t._v(t._s(t._f("dateFmtROCMMDD")(t.resultItem.date)))]),s("p",{staticClass:"w-1/3"},[t._v(t._s(t._f("dateFmtHm")(t.resultItem.date)))])]),s("div",{staticClass:"mb-2 flex items-center border-b border-solid border-primary/5 pb-1"},[s("p",{staticClass:"w-1/3 font-bold"},[t._v("姓名:")]),s("p",{staticClass:"w-2/3"},[t._v(t._s(t.resultItem.customer.name))])]),s("div",{staticClass:"mb-2 flex items-center border-b border-solid border-primary/5 pb-1"},[s("p",{staticClass:"w-1/3 font-bold"},[t._v("電話:")]),s("p",{staticClass:"w-2/3"},[t._v(t._s(t.resultItem.customer.cellphone))])]),s("div",{staticClass:"mb-2 flex items-center border-b border-solid border-primary/5 pb-1"},[s("p",{staticClass:"w-1/3 font-bold"},[t._v("設計師:")]),s("p",{staticClass:"w-2/3",class:{"text-rejectText font-extrabold":t.userInfo.user.id!==t.resultItem.designer.id}},[t._v(t._s(t.resultItem.designer?t.resultItem.designer.name:t.resultItem.designer))])]),s("div",{staticClass:"mb-2 flex items-center border-b border-solid border-primary/5 pb-1"},[s("p",{staticClass:"w-1/3 font-bold"},[t._v("同行人數:")]),s("p",{staticClass:"w-2/3"},[t._v(t._s(t.resultItem.friends.length)+"人")])]),s("div",{staticClass:"mb-2 flex border-b border-solid border-primary/5 pb-1"},[s("label",{staticClass:"w-1/3 font-bold"},[t._v("備註:")]),s("div",{staticClass:"relative w-2/3"},[t.isEdit?s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.resultItem.remark,expression:"resultItem.remark"}],staticClass:"w-full rounded-md border border-primary/50",attrs:{name:"remark",id:"",rows:"5"},domProps:{value:t.resultItem.remark},on:{input:function(e){e.target.composing||t.$set(t.resultItem,"remark",e.target.value)}}}):s("p",{staticClass:"text-rejectText"},[t._v(t._s(t.resultItem.remark))]),""!==t.resultItem.remark&&t.isEdit?s("font-awesome-icon",{staticClass:" absolute right-2 bottom-2 text-rose-600",attrs:{icon:"fa-regular fa-xmark"},on:{click:function(e){t.resultItem.remark=""}}}):t._e()],1)]),s("div",{staticClass:"mb-2 flex border-b border-solid border-primary/5 pb-1"},[s("label",{staticClass:"w-1/3 font-bold"},[t._v("顧客備註:")]),s("div",{staticClass:"relative w-2/3"},[s("p",{staticClass:"w-full",attrs:{name:"remark"}},[t._v(t._s(t.resultItem.remarkForCustomer))])])])]),"待審查"===t.resultItem.status?s("div",{staticClass:"mt-4"},[s("p",{staticClass:"text-center text-lg font-semibold"},[t._v("選擇審查狀態")]),s("div",{staticClass:"m-auto flex max-w-[475px] justify-around p-2"},[s("div",{staticClass:" w-1/3 cursor-pointer rounded bg-sucessText px-[14px] py-2 text-sm text-white",on:{click:function(e){return t.toggleDialog("accept")},keypress:function(e){return t.toggleDialog("accept")}}},[t._v("接單")]),s("div",{staticClass:" w-1/3 cursor-pointer rounded bg-rejectText px-[14px] py-2 text-sm text-white",on:{click:function(e){return t.toggleDialog("reject")},keypress:function(e){return t.toggleDialog("reject")}}},[t._v("拒絕")])])]):t._e(),t.userInfo.user.id===t.resultItem.designer.id?["待審查"!==t.resultItem.status&&"已完成"!==t.resultItem.status?s("div",{staticClass:"mt-4"},[s("p",{staticClass:"text-center text-lg font-semibold"},[t._v("選擇審查狀態")]),s("div",{staticClass:"m-auto flex max-w-[475px] justify-around p-2"},[s("div",{staticClass:" flex w-1/3 cursor-pointer items-center justify-center gap-2 rounded bg-sucessText px-[14px] py-2 text-sm text-white",on:{click:function(e){return t.updateVerifyBookingInput(t.resultItem,!0)},keypress:function(e){return t.updateVerifyBookingInput(t.resultItem,!0)}}},["預約成功"===t.resultItem.status?s("font-awesome-icon",{staticClass:"animate__animated animate__heartBeat animate__fast text-xl",attrs:{icon:"fa-regular fa-circle-check"}}):t._e(),s("span",[t._v("接單")])],1),s("div",{staticClass:" flex w-1/3 cursor-pointer items-center justify-center gap-2 rounded bg-rejectText px-[14px] py-2 text-sm text-white",on:{click:function(e){return t.updateVerifyBookingInput(t.resultItem,!1)},keypress:function(e){return t.updateVerifyBookingInput(t.resultItem,!1)}}},["設計師已取消"===t.resultItem.status?s("font-awesome-icon",{staticClass:"animate__animated animate__heartBeat animate__fast text-xl",attrs:{icon:"fa-regular fa-circle-check"}}):t._e(),s("span",[t._v("拒絕")])],1)])]):t._e(),"0"!==t.resultItem.status?s("div",{staticClass:"m-auto flex max-w-[475px] justify-around p-2"},[s("div",{staticClass:"w-full cursor-pointer bg-second py-2 px-4 text-white",on:{click:function(e){t.doSubmitEdit(),t.isEdit=!t.isEdit},keypress:function(e){t.doSubmitEdit(),t.isEdit=!t.isEdit}}},[t._v(t._s(t.isEdit?"儲存預約":"修改預約"))])]):t._e()]:t._e()],2):t._e()],1)},a=[],i=s(4648),n=s(6835),o=s(8534),u=s(629),c={name:"order-edit",description:"預約單的審查",metaInfo:{title:"名留",titleTemplate:"%s | 預約"},mounted:function(){this.init()},data:function(){return{isEdit:!1,resultItem:null}},activated:function(){this.init()},methods:{init:function(){var t=this;return(0,o.Z)((0,n.Z)().mark((function e(){return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getOrder(t.$route.query.id);case 2:case"end":return e.stop()}}),e)})))()},doRoute:function(){this.$router.push({name:"ScheduleBreak"})},getOrder:function(t){var e=this;return(0,o.Z)((0,n.Z)().mark((function s(){var r,a,i,o;return(0,n.Z)().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,e.$api.order({orderId:t});case 2:if(r=s.sent,a=r.data,i=a.data,o=a.errors,!o){s.next=6;break}return s.abrupt("return",{});case 6:return e.resultItem=i.order,s.abrupt("return",r);case 8:case"end":return s.stop()}}),s)})))()},doSubmitEdit:function(){var t=this;return(0,o.Z)((0,n.Z)().mark((function e(){var s,r,a,i;return(0,n.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isEdit){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,t.$api.updateBooking({id:t.$route.query.id,remark:t.resultItem.remark});case 4:if(s=e.sent,r=s.data,a=r.data,i=r.errors,!i){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,t.getOrder(a.updateBooking.id);case 10:t.$swal.fire({title:" ",html:'<div class="flex items-center justify-center">\n          <img src="/designer/assets/images/success.svg" alt="" class="inline-block mr-1" /><span>修改成功</span>\n        </div>\n        <br/>',confirmButtonText:"回到列表",showConfirmButton:!0,showCloseButton:!0,customClass:{confirmButton:"!w-[144px] !rounded !bg-second !px-[14px] !py-2 !text-sm !text-white"}}).then((function(e){e.isConfirmed&&t.doRoute()}));case 11:case"end":return e.stop()}}),e)})))()},toggleDialog:function(t){var e=this;this.$swal.fire({input:"text",title:" ",html:'<div class="flex items-center justify-center">\n          '.concat("accept"===t?'<img src="/designer/assets/images/success.svg" alt="" class="inline-block mr-1" /><span>確認接單</span>':'<img src="/designer/assets/images/error.svg" alt="" class="inline-block mr-1" /><span>已拒絕</span>',"\n        </div>"),inputPlaceholder:"請輸入備註說明",confirmButtonText:"送出",showConfirmButton:!0,showCloseButton:!0,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp animate__faster"},customClass:{confirmButton:"!w-[144px] !rounded !bg-second !px-[14px] !py-2 !text-sm !text-white"}}).then((function(s){s.isConfirmed&&e.$swal.fire({showCloseButton:!0,html:'<div class="flex items-center justify-center my-10">\n              '.concat("accept"===t?'<img src="/designer/assets/images/success.svg" alt="" class="inline-block mr-1" /><span>接單成功</span>':'<img src="/designer/assets/images/error.svg" alt="" class="inline-block mr-1" /><span>拒絕成功</span>',"\n            </div>"),showConfirmButton:!1,timer:3e3,timerProgressBar:!0}).then((function(){e.doRoute()}))}))},updateVerifyBookingInput:function(t,e){var s=this;return(0,o.Z)((0,n.Z)().mark((function r(){var a,i;return(0,n.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if("預約成功"!==t.status||!e){r.next=2;break}return r.abrupt("return");case 2:if("設計師已取消"!==t.status||e){r.next=4;break}return r.abrupt("return");case 4:return r.next=6,s.$api.VerifyBookingInput({orderId:t.id,isApproval:e});case 6:if(a=r.sent,i=a.data.errors,!i){r.next=10;break}return r.abrupt("return");case 10:return r.next=12,s.getOrder(s.$route.query.id);case 12:case"end":return r.stop()}}),r)})))()}},computed:(0,i.Z)({},(0,u.rn)("userInfo",["userInfo"]))},l=c,d=s(3736),m=(0,d.Z)(l,r,a,!1,null,"1579e53e",null),p=m.exports}}]);
//# sourceMappingURL=339-legacy.2fb13e5d.js.map