"use strict";(self["webpackChunkbos_designer"]=self["webpackChunkbos_designer"]||[]).push([[864],{9864:function(e,t,r){r.r(t),r.d(t,{default:function(){return m}});var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("main",{staticClass:"box-border h-full min-h-[calc(100vh-84px)] w-full pb-[84px]"},[r("C-Back-Nav",{attrs:{title:(""!==e.GETTER_MECHANTNAME?e.GETTER_MECHANTNAME+" - ":"")+"預約"}}),r("section",{staticClass:"relative z-0 mt-[52px] p-3"},[r("div",{staticClass:"mb-4 flex items-center justify-between"},[r("div",{staticClass:"rounded-[10px] bg-primary px-[14px] py-1 text-white",on:{click:function(t){return e.$router.push({name:"Order-add"})},keypress:function(t){return e.$router.push({name:"Order-add"})}}},[r("font-awesome-icon",{attrs:{icon:"fa-regular fa-circle-plus"}}),r("span",{staticClass:"ml-[6px]"},[e._v("新增預約")])],1),r("div",{staticClass:" flex items-center gap-2 text-left"},[r("div",{staticClass:"inline-block w-fit cursor-pointer rounded-[10px] bg-primary px-2 py-1 text-white",on:{click:function(t){return e.$router.push({name:"Order-list"})},keypress:function(t){return e.$router.push({name:"Order-list"})}}},[r("span",{staticClass:"mr-[6px]"},[e._v("列表查詢")]),r("font-awesome-icon",{attrs:{icon:"fa-regular fa-list"}})],1)])]),r("div",{staticClass:"mb-4 flex items-center justify-between gap-2"},[r("C-Input",{ref:"inputVal",staticClass:"mb-0 w-full",attrs:{placeholder:"搜尋姓名、電話、代號"},on:{doFunction:e.getOrders},scopedSlots:e._u([{key:"endIcon",fn:function(){return[""!==e.searchForm.keyword?r("font-awesome-icon",{staticClass:" text-rose-600",attrs:{icon:"fa-regular fa-xmark"},on:{click:e.doInitSearch}}):e._e(),r("font-awesome-icon",{attrs:{icon:"fa-regular fa-magnifying-glass"},on:{click:e.getOrders}})]},proxy:!0}]),model:{value:e.searchForm.keyword,callback:function(t){e.$set(e.searchForm,"keyword",t)},expression:"searchForm.keyword"}})],1),r("transition",{attrs:{name:"collapseTransition"}},[r("vc-date-picker",{directives:[{name:"show",rawName:"v-show",value:e.isActiveCalendar,expression:"isActiveCalendar"}],staticClass:"relative mt-[50px]",attrs:{locale:"zh-TW","select-attribute":e.selectedAttribute,"is-expanded":"",attributes:e.attrs,masks:e.masks},on:{"update:to-page":function(t){return e.swipeMonth(t)}},scopedSlots:e._u([{key:"header",fn:function(t){var s=t.year,a=t.monthLabel;return[r("div",{staticClass:"absolute inset-x-0 top-[-50px] w-full"},[r("div",{staticClass:"flex items-center justify-center"},[r("span",{staticClass:"font-bold"},[e._v(e._s(e._f("dateFormat")(s))+"年")]),r("span",{staticClass:"ml-2 text-2xl font-bold"},[e._v(e._s(a))])])])]}},{key:"header-left-button",fn:function(){return[r("font-awesome-icon",{staticClass:"absolute left-0 top-[-46px] text-2xl text-primary",attrs:{icon:"fa-solid fa-angle-left"},on:{click:function(t){return e.preNextMonth(-1)}}})]},proxy:!0},{key:"header-right-button",fn:function(){return[r("font-awesome-icon",{staticClass:"absolute right-0 top-[-46px] text-2xl text-primary",attrs:{icon:"fa-solid fa-angle-right"},on:{click:function(t){return e.preNextMonth(1)}}})]},proxy:!0},{key:"day-content",fn:function(t){var s=t.day,a=t.attributes;return[r("div",{staticClass:"z-10 flex flex-col"},[r("div",[r("p",{staticClass:"day-label relative my-2 text-sm text-gray-900",class:[e.$dayjs(e.searchForm.selectedDate).valueOf()===e.$dayjs(s.date).valueOf()?" before:contents-[``] before:m-auto  before:absolute before:inline-block before:h-[24px] before:w-[24px] before:top-[-1px] before:left-0 before:right-0 before:bg-[#feb401] before:z-[-1] before:rounded-[50%]":""],on:{click:function(t){e.searchForm.selectedDate=e.$dayjs(s.date).valueOf()},keypress:function(t){e.searchForm.selectedDate=e.$dayjs(s.date).valueOf()}}},[e._v(e._s(s.day))])]),r("div",{staticClass:"m-auto inline-block max-w-[13vmin] break-all"},[e.hasOnlyOrder(a)?r("span",{staticClass:"m-[2px] inline-block h-[5px] w-[5px] rounded-[50%] bg-[#feb401] content-['']"}):e._e()])])]}}]),model:{value:e.searchForm.selectedDate,callback:function(t){e.$set(e.searchForm,"selectedDate",t)},expression:"searchForm.selectedDate"}})],1),r("div",{staticClass:"text-left text-sm"},[r("p",{staticClass:"before:contents-[''] relative my-3 pl-2 before:absolute before:inset-0 before:h-full before:w-1 before:bg-primary"},[e._v("待審查("+e._s(e.isReviewResult)+")")]),e.isReviewResult?r("div",e._l(e.reviewResult,(function(t,s){return r("div",{key:"reviewItem"+s,staticClass:"mb-3 flex cursor-pointer items-center justify-between border-b border-solid border-primary/50 py-1 pl-2",on:{click:function(r){return e.doRoute(t,!0)},keypress:function(r){return e.doRoute(t,!0)}}},[r("div",{staticClass:"w-3/12"},[r("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-regular fa-calendar-days"}}),r("span",[e._v(e._s(e._f("dateFmtROCMMDD")(t.date)))])],1),r("div",{staticClass:"w-3/12"},[r("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-solid fa-clock-five"}}),r("span",[e._v(e._s(e._f("dateFmtHm")(t.date)))])],1),r("div",{staticClass:"w-3/12 overflow-hidden text-ellipsis whitespace-nowrap"},[r("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-solid fa-user"}}),r("span",[e._v(e._s(t.customer.name||"--"))])],1),r("div",{staticClass:"w-3/12 min-w-[42px]"},[r("span",{staticClass:"text-sucessText"},[e._v(e._s(t.status))])]),r("div",[r("font-awesome-icon",{attrs:{icon:"fa-solid fa-angle-right"}})],1)])})),0):r("div",{staticClass:"my-3  pl-2"},[e._v("目前沒有待審查的預約")])]),r("div",{staticClass:"text-left text-sm"},[r("p",{staticClass:"before:contents-[''] relative my-3 pl-2 before:absolute before:inset-0 before:h-full before:w-1 before:bg-primary"},[e._v("預約明細("+e._s(e.isOrderResult)+")")]),e.isOrderResult?r("div",e._l(e.orderResult,(function(t,s){return r("div",{key:"reviewItem"+s,staticClass:"mb-3 flex cursor-pointer items-center justify-between border-b border-solid border-primary/50 py-1 pl-2",on:{click:function(r){return e.doRoute(t,!1)},keypress:function(r){return e.doRoute(t,!1)}}},[r("div",{staticClass:"w-3/12"},[r("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-regular fa-calendar-days"}}),r("span",[e._v(e._s(e._f("dateFmtROCMMDD")(t.date)))])],1),r("div",{staticClass:"w-2/12"},[r("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-solid fa-clock-five"}}),r("span",[e._v(e._s(e._f("dateFmtHm")(t.date)))])],1),r("div",{staticClass:"w-3/12 overflow-hidden text-ellipsis whitespace-nowrap"},[r("font-awesome-icon",{staticClass:"mr-1",attrs:{icon:"fa-solid fa-user"}}),r("span",[e._v(e._s(t.customer.name||"--"))])],1),r("div",{staticClass:"w-3/12 min-w-[42px]"},[r("span",[e._v(e._s(t.status))])]),r("div",[r("font-awesome-icon",{attrs:{icon:"fa-solid fa-angle-right"}})],1)])})),0):r("div",{staticClass:"my-3  pl-2"},[e._v("目前沒有任何預約")])])],1)],1)},a=[],n=r(4648),i=r(6835),o=r(8534),c=(r(1539),r(8783),r(3948),r(6535),r(9244),r(7327),r(629)),l={name:"order-index",description:"預約的首頁",metaInfo:{title:"名留",titleTemplate:"%s | 預約"},mounted:function(){this.init()},data:function(){return{masks:{weekdays:"WWW"},isActiveCalendar:!0,searchForm:{keyword:"",isAccurate:!0,selectedDate:this.$dayjs(this.$dayjs().format("YYYY-MM-DD")).valueOf()},monthkyOrdersDate:{start:this.$dayjs(new Date).startOf("month").valueOf(),end:this.$dayjs(new Date).endOf("month").valueOf()},attrs:[],reviewResult:[],orderResult:[],selectedAttribute:{highlight:{style:{background:"transparent"},fillMode:"solid"}}}},methods:{init:function(){var e=this;return(0,o.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([e.getMonthlyOrders(),e.getOrders()]).then((function(){}));case 2:case"end":return t.stop()}}),t)})))()},doInitSearch:function(){var e=this;return(0,o.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.searchForm.keyword="",t.next=3,e.getOrders();case 3:case"end":return t.stop()}}),t)})))()},getMonthlyOrders:function(){var e=this;return(0,o.Z)((0,i.Z)().mark((function t(){var r,s,a,n;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("getMonthlyOrders"),t.next=3,e.$api.orders({startDate:e.$dayjs(e.monthkyOrdersDate.start).isValid()?e.$dayjs(e.monthkyOrdersDate.start).valueOf():"",endDate:e.$dayjs(e.monthkyOrdersDate.end).isValid()?e.$dayjs(e.monthkyOrdersDate.end).valueOf():"",employeeId:e.userInfo.user.id,isReserved:!0});case 3:if(r=t.sent,s=r.data,a=s.data,n=s.errors,!n){t.next=7;break}return t.abrupt("return",{});case 7:return e.attrs=Array.isArray(a.orders.orders)?a.orders.orders.flatMap((function(e){return"待審核"===e.status?[{key:"".concat(e.id),customData:{class:"red"},dates:e.date}]:[{key:"".concat(e.id),dates:e.date}]})):[],e.$forceUpdate(),t.abrupt("return",r);case 10:case"end":return t.stop()}}),t)})))()},getOrders:function(){var e=this;return(0,o.Z)((0,i.Z)().mark((function t(){var r,s,a,n;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.orders({startDate:e.$dayjs(e.searchForm.selectedDate).isValid()?e.$dayjs(e.searchForm.selectedDate).valueOf():"",endDate:e.$dayjs(e.searchForm.selectedDate).isValid()?e.$dayjs(e.searchForm.selectedDate).valueOf():"",employeeId:e.userInfo.user.id,orderKeyword:{keyword:"string"===typeof e.searchForm.keyword?e.searchForm.keyword.toLocaleLowerCase():e.searchForm.keyword,isFuzzySearch:!0},isReserved:!0});case 2:if(r=t.sent,s=r.data,a=s.data,n=s.errors,!n){t.next=6;break}return t.abrupt("return",{});case 6:return e.reviewResult=a.orders.orders.filter((function(e){return"待審核"===e.status})),e.orderResult=a.orders.orders.filter((function(e){return"待審核"!==e.status})),e.$forceUpdate(),t.abrupt("return",r);case 10:case"end":return t.stop()}}),t)})))()},doRoute:function(e,t){this.$router.push({name:"Order-edit",query:{id:e.id,isReview:t}})},preNextMonth:function(e){this.monthkyOrdersDate.start=this.$dayjs(this.$dayjs(this.monthkyOrdersDate.start).add(e,"month")).startOf("month").format("YYYY-MM-DD"),this.monthkyOrdersDate.end=this.$dayjs(this.$dayjs(this.monthkyOrdersDate.end).add(e,"month")).endOf("month").format("YYYY-MM-DD")},swipeMonth:function(e){var t=e.year,r=e.month-1,s=new Date(t,r,1),a=new Date(t,r+1,0),n=this.$dayjs(s).format("YYYY-MM-DD"),i=this.$dayjs(a).format("YYYY-MM-DD");this.monthkyOrdersDate.start=n,this.monthkyOrdersDate.end=i}},computed:(0,n.Z)((0,n.Z)((0,n.Z)({},(0,c.rn)("userInfo",["userInfo","currentMechantId"])),(0,c.Se)("userInfo",["GETTER_MECHANTNAME"])),{},{isReviewResult:function(){return this.reviewResult.length},hasOnlyOrder:function(){return function(e){var t=!1;return Array.isArray(e)&&1===e.length&&(t=!e[0].highlight),Array.isArray(e)&&e.length>1&&(t=!0),t}},isOrderResult:function(){return this.orderResult.length}}),watch:{"searchForm.selectedDate":{handler:function(){this.searchForm.selectedDate&&this.getOrders()}},monthkyOrdersDate:{deep:!0,handler:function(){this.getMonthlyOrders()}}}},d=l,u=r(3736),f=(0,u.Z)(d,s,a,!1,null,"249b794b",null),m=f.exports}}]);
//# sourceMappingURL=864-legacy.716c99bb.js.map