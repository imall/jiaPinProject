"use strict";(self["webpackChunkbos_designer"]=self["webpackChunkbos_designer"]||[]).push([[833],{4833:function(e,t,r){r.r(t),r.d(t,{default:function(){return p}});var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("main",{staticClass:"h-full w-full overflow-auto"},[n("section",{staticClass:"relative box-border min-h-screen w-full overflow-auto pb-[84px] md:rounded-2xl"},[n("nav",{staticClass:"relative mt-[41px] flex w-full items-end justify-between p-[14px]"},[n("img",{attrs:{src:r(1389),alt:""}}),n("C-Select",{staticClass:"w-[130px] text-center",attrs:{list:e.merchentList,placeholder:"選擇店家","item-text":"name","item-value":"id"},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1),n("div",{staticClass:"m-auto my-6 mx-[14px] box-border flex h-fit w-[calc(100%-28px)] flex-wrap items-center justify-between rounded-[10px] border border-black py-[7px] px-4"},[n("div",{staticClass:"flex items-center justify-center"},[n("font-awesome-icon",{staticClass:"mr-4 text-2xl",attrs:{icon:"fa-regular fa-user"}}),n("div",{staticClass:" text-lg leading-8"},[e._v("設計師: "),n("span",{staticClass:"ml-2"},[e._v(e._s(e.userInfo?e.userInfo.user.name:""))])])],1),n("font-awesome-icon",{staticClass:"cursor-pointer text-2xl",attrs:{icon:"fa-regular fa-right-from-bracket"},on:{click:e.doLogout}})],1),n("div",{staticClass:"m-auto box-border flex h-fit w-full flex-wrap justify-around gap-4 px-[14px]"},[e._l(e.servicesList,(function(t,r){return[e.isAuthority(t.itemName)?n("div",{key:t.routeName+r,staticClass:"flex h-[100px] w-[165px] cursor-pointer flex-col items-center justify-center gap-3 rounded-[10px] border border-solid border-[#AEAEAE] bg-white shadow-2xl",on:{click:function(r){return e.doRoute(t.routeName)},keydown:function(r){return e.doRoute(t.routeName)}}},[n("img",{attrs:{src:t.iconSrc,alt:""}}),n("div",[e._v(e._s("設計師日報表"===t.itemName?"報表":t.itemName))])]):e._e()]}))],2),n("div",{staticClass:"fixed bottom-5 right-4 flex h-14 w-14 cursor-pointer items-center justify-center rounded-[28px] border border-solid  bg-white shadow-xl",on:{click:e.shareLink,keypress:e.shareLink}},[n("font-awesome-icon",{staticClass:"mr-1 text-4xl text-[#365cad]",attrs:{icon:"fa-regular fa-share-nodes"}})],1)])])},a=[],i=r(6084),s=r(6835),o=r(8534),c=r(4648),u=(r(9826),r(1539),r(2222),r(8309),r(8783),r(3948),r(4916),r(5306),r(6535),r(9244),r(7327),r(629)),l=r(2325),f={name:"home-index",metaInfo:{title:"名留",titleTemplate:"%s | 首頁"},data:function(){return{selected:"",merchentList:[],servicesList:[{itemName:"預約審查",routeName:"Order",iconSrc:r(8929)},{itemName:"打卡",routeName:"Punch",iconSrc:r(823)},{itemName:"行事曆",routeName:"ScheduleBreak",iconSrc:r(5773)},{itemName:"設計師日報表",routeName:"Report",iconSrc:r(3665)},{itemName:"客戶資料查詢",routeName:"Customer",iconSrc:r(7962)}]}},computed:(0,c.Z)((0,c.Z)({},(0,u.rn)("userInfo",["userInfo","currentMechantId","userAuthorizeList"])),{},{isAuthority:function(){var e=this;return function(t){return e.userAuthorizeList.find((function(e){return e.pageName===t&&e.authority}))}}}),mounted:function(){this.init()},methods:(0,c.Z)((0,c.Z)({},(0,u.nv)("userInfo",["SET_USER_PROFILE","SET_USER_CURRENT_MERCHANTID","SET_USER_AUTHORIZELIST"])),{},{shareLink:function(){var e=this;return(0,o.Z)((0,s.Z)().mark((function t(){var r;return(0,s.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r="".concat(window.location.protocol,"//").concat(window.location.hostname,"/login/?merchantId=").concat(e.currentMechantId,"&designerId=").concat(e.userInfo.user.id),!navigator.share){t.next=6;break}return t.next=4,navigator.share({title:"MINGLIU GROUP 名留集團",text:"MINGLIU GROUP 名留集團 設計師預約 設計師: ".concat(e.userInfo.user.name),url:r}).then((function(){return console.log("success")})).catch((function(e){window.open(r),console.error(e)}));case 4:t.next=7;break;case 6:window.open(r);case 7:case"end":return t.stop()}}),t)})))()},doRoute:function(e){this.$router.push({name:e})},init:function(){var e=this;return(0,o.Z)((0,s.Z)().mark((function t(){var r,n;return(0,s.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([e.getMechants()]).then((function(){}));case 2:r=(0,i.Z)(e.userInfo.user.merchants,1),n=r[0],e.selected=e.currentMechantId||n.id||"";case 4:case"end":return t.stop()}}),t)})))()},getMechants:function(){var e=this;return(0,o.Z)((0,s.Z)().mark((function t(){var r,n,a,i;return(0,s.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.user({id:e.userInfo.user.id});case 2:if(r=t.sent,n=r.data,a=n.data,i=n.errors,!i){t.next=6;break}return t.abrupt("return");case 6:e.merchentList=a.user.merchants;case 7:case"end":return t.stop()}}),t)})))()},doLogout:function(){var e=this;this.$swal.fire({icon:"question",title:"您確定要登出嗎?",showConfirmButton:!0,showCancelButton:!0,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp animate__faster"}}).then(function(){var t=(0,o.Z)((0,s.Z)().mark((function t(r){var n,a,i,o;return(0,s.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r.isConfirmed){t.next=12;break}return t.next=3,e.$api.userLogout();case 3:if(n=t.sent,a=n.data,i=a.data,o=a.errors,!o){t.next=7;break}return t.abrupt("return");case 7:if(i.userLogout){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,e.SET_USER_PROFILE(null);case 11:e.$swal.fire({icon:"success",title:"登出成功",showConfirmButton:!1,showCancelButton:!1,showClass:{popup:"animate__animated animate__fadeInDown"},hideClass:{popup:"animate__animated animate__fadeOutUp animate__faster"},timer:3e3,timerProgressBar:!0}).then((function(){e.$router.replace({name:"Login"})}));case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},getMe:function(){var e=this;return(0,o.Z)((0,s.Z)().mark((function t(){var r,n,a,i;return(0,s.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.me();case 2:if(r=t.sent,n=r.data,a=n.data,i=n.errors,!i){t.next=6;break}return t.abrupt("return");case 6:try{e.merchantIdentity=a.me.merchantIdentity}catch(s){e.merchantIdentity={}}case 7:case"end":return t.stop()}}),t)})))()},getMerchantAuthorities:function(){var e=this;return(0,o.Z)((0,s.Z)().mark((function t(){var r,n,a,i;return(0,s.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$api.getMerchantAuthorities();case 2:if(r=t.sent,n=r.data,a=n.data,i=n.errors,!i){t.next=6;break}return t.abrupt("return");case 6:try{e.merchantAuthorities=a.getMerchantAuthorities}catch(s){e.merchantAuthorities=[]}case 7:case"end":return t.stop()}}),t)})))()},permissionReportList:function(){var e=this;return new Promise((function(t){var r=e.merchantAuthorities.find((function(t){return t.id===e.merchantIdentity.authorityId})),n=r&&(0,l.p)(r.authoritySettings)?JSON.parse(r.authoritySettings):[];console.log(n);var a=n.flatMap((function(e){return"設計師端權限設定"!==e.pageTitle?[]:e.pageAuthority})),i=a.filter((function(e){return e.authority}));t(i)}))},swtichAuthority:function(e){var t=this;return(0,o.Z)((0,s.Z)().mark((function r(){var n;return(0,s.Z)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.SET_USER_CURRENT_MERCHANTID(e);case 2:return r.next=4,t.getMe();case 4:return r.next=6,t.getMerchantAuthorities();case 6:return r.next=8,t.permissionReportList();case 8:return n=r.sent,r.next=11,t.SET_USER_AUTHORIZELIST(n);case 11:case"end":return r.stop()}}),r)})))()}}),watch:{selected:function(e){this.swtichAuthority(e)}}},h=f,m=r(3736),d=(0,m.Z)(h,n,a,!1,null,null,null),p=d.exports},8929:function(e,t,r){e.exports=r.p+"img/calendar-check-regular.20a22088.svg"},5773:function(e,t,r){e.exports=r.p+"img/calendar-days-regular.23986aa5.svg"},3665:function(e,t,r){e.exports=r.p+"img/chart-mixed-solid.096fb115.svg"},823:function(e,t,r){e.exports=r.p+"img/clock-regular.81063c4e.svg"},7962:function(e,t,r){e.exports=r.p+"img/users-light.3357b944.svg"}}]);
//# sourceMappingURL=833-legacy.fffbc3da.js.map