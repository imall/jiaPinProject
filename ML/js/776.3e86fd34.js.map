{"version":3,"file":"js/776.3e86fd34.js","mappings":"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","sources":["webpack://bos-designer/./src/views/Home/customer/index.vue?fcc1","webpack://bos-designer/src/views/Home/customer/index.vue","webpack://bos-designer/./src/views/Home/customer/index.vue?9aa6","webpack://bos-designer/./src/views/Home/customer/index.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('main',{staticClass:\"w-ful box-border  h-full bg-white/80 pb-[84px]\"},[_c('C-Back-Nav',{attrs:{\"title\":'客戶資料查詢'}}),_c('section',{staticClass:\"relative z-0 mt-[52px] p-3\"},[_c('div',{staticClass:\"mb-4 flex items-center justify-between\"},[_c('C-Input',{staticClass:\"mb-0 mr-2 w-full\",attrs:{\"placeholder\":'搜尋姓名、手機、代號'},on:{\"input\":_vm.doInitSearch},scopedSlots:_vm._u([{key:\"endIcon\",fn:function(){return [(_vm.submitForm.searchInput !== '')?_c('font-awesome-icon',{staticClass:\" text-rose-600\",attrs:{\"icon\":\"fa-regular fa-xmark\"},on:{\"click\":function($event){_vm.submitForm.searchInput = '', _vm.doInitSearch()}}}):_vm._e(),_c('font-awesome-icon',{attrs:{\"icon\":\"fa-regular fa-magnifying-glass\"}})]},proxy:true}]),model:{value:(_vm.submitForm.searchInput),callback:function ($$v) {_vm.$set(_vm.submitForm, \"searchInput\", $$v)},expression:\"submitForm.searchInput\"}}),_c('font-awesome-icon',{staticClass:\"text-2xl\",attrs:{\"icon\":\"fa-regular fa-filter-list\"},on:{\"click\":function($event){_vm.isActiveFilter = !_vm.isActiveFilter}}})],1),_vm._l((_vm.resultList),function(item,index){return _c('div',{key:(\"result\" + index),staticClass:\"mb-4 flex items-center justify-between border-b border-solid border-primary/30\",on:{\"click\":function($event){return _vm.doRoute(item)},\"keypress\":function($event){return _vm.doRoute(item)}}},[_c('div',{staticClass:\"w-2/12\"},[_vm._v(_vm._s(+index+1 > 9 ? +index+1 :(\"0\" + (+index+1))))]),_c('div',{staticClass:\"w-2/12 overflow-hidden text-ellipsis whitespace-nowrap\"},[_vm._v(_vm._s(item.name ? item.name : '--'))]),_c('div',{staticClass:\"w-4/12\"},[_vm._v(_vm._s(item.cellphone))]),_c('div',{staticClass:\"w-3/12 text-right\"},[(item.birthday)?_c('span',[_vm._v(\" \"+_vm._s(item.birthday.year && item.birthday.year !== '0' ? ((item.birthday.year) + \"/\") : '')+_vm._s(item.birthday.month && item.birthday.month !== '0' ? ((item.birthday.month) + \"/\") : '--.')+_vm._s(item.birthday.day && item.birthday.day !== '0' ? item.birthday.day : '--')+\" \")]):_vm._e()]),_c('font-awesome-icon',{staticClass:\"w-1/12\",attrs:{\"icon\":\"fa-solid fa-angle-right\"}})],1)})],2),_c('C-Filter-Wrap',{attrs:{\"searchAdvanceCtx\":_vm.searchAdvanceCtx},on:{\"doFunction\":function($event){return _vm.doInitSearch(true)},\"clearFunction\":_vm.clearSearchAdvanceCtx},model:{value:(_vm.isActiveFilter),callback:function ($$v) {_vm.isActiveFilter=$$v},expression:\"isActiveFilter\"}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <main class=\"w-ful box-border  h-full bg-white/80 pb-[84px]\">\n    <C-Back-Nav :title=\"'客戶資料查詢'\" ></C-Back-Nav>\n    <section class=\"relative z-0 mt-[52px] p-3\">\n\n      <div class=\"mb-4 flex items-center justify-between\">\n        <C-Input v-model=\"submitForm.searchInput\" @input=\"doInitSearch\" :placeholder=\"'搜尋姓名、手機、代號'\" class=\"mb-0 mr-2 w-full\">\n          <template v-slot:endIcon>\n            <font-awesome-icon v-if=\"submitForm.searchInput !== ''\" @click=\"submitForm.searchInput = '', doInitSearch()\" icon=\"fa-regular fa-xmark\" class=\" text-rose-600\"/>\n            <font-awesome-icon icon=\"fa-regular fa-magnifying-glass\" />\n          </template>\n        </C-Input>\n        <font-awesome-icon icon=\"fa-regular fa-filter-list\" class=\"text-2xl\" @click=\"isActiveFilter = !isActiveFilter\"/>\n      </div>\n      <!-- eslint-disable-next-line -->\n      <div v-for=\"(item,index) in resultList\" :key=\"`result${index}`\" class=\"mb-4 flex items-center justify-between border-b border-solid border-primary/30\" @click=\"doRoute(item)\" @keypress=\"doRoute(item)\">\r\n        <div class=\"w-2/12\">{{+index+1 > 9 ? +index+1 :`0${+index+1}`}}</div>\n        <div class=\"w-2/12 overflow-hidden text-ellipsis whitespace-nowrap\">{{item.name ? item.name : '--'}}</div>\n        <div class=\"w-4/12\">{{item.cellphone}}</div>\n        <div class=\"w-3/12 text-right\">\n          <span v-if=\"item.birthday\">\n            {{item.birthday.year && item.birthday.year !== '0' ? `${item.birthday.year}/` : ''}}{{item.birthday.month && item.birthday.month !== '0' ? `${item.birthday.month}/` : '--.'}}{{item.birthday.day && item.birthday.day !== '0' ? item.birthday.day : '--'}}\n          </span>\n        </div>\n        <font-awesome-icon icon=\"fa-solid fa-angle-right\" class=\"w-1/12\"/>\n      </div>\n\n    </section>\n\n    <C-Filter-Wrap v-model=\"isActiveFilter\" :searchAdvanceCtx=\"searchAdvanceCtx\" @doFunction=\"doInitSearch(true)\" @clearFunction=\"clearSearchAdvanceCtx\"></C-Filter-Wrap>\n\n  </main>\n</template>\n\n<script>\nimport { mapState } from 'vuex';\n// eslint-disable-next-line no-unused-vars\nimport month from '@/assets/constant/month';\n\nconst searchAdvanceCtxTemplate = {\n  year: '',\n  month: '',\n  day: '',\n  customerIsCome: null,\n  consumptionRange: {\n    startDate: '',\n    endDate: '',\n  },\n  baseDateRange: {\n    baseDate: '',\n    toDate: '',\n    dayNumber: '',\n  },\n};\nexport default {\n  name: 'customer-index',\n  description: '客戶資料查詢的首頁',\n  metaInfo: {\n    title: '名留',\n    titleTemplate: '%s | 客戶資料查詢',\n  },\n  mounted() {\n    this.init();\n  },\n  // 離開頁面取消監聽事件\n  beforeDestroy() {\n    window.removeEventListener('scroll', this.scrollDoSearch);\n  },\n  data() {\n    return {\n      isActiveFilter: false,\n      submitForm: {\n        searchInput: '',\n        pageOffset: 0,\n        isEnd: false,\n      },\n      totalPage: 0,\n      isGetting: false,\n      searchAdvanceCtx: {\n        year: '',\n        month: '',\n        day: '',\n        customerIsCome: null,\n        consumptionRange: {\n          startDate: '',\n          endDate: '',\n        },\n        baseDateRange: {\n          baseDate: '',\n          toDate: '',\n          dayNumber: '',\n        },\n      },\n      resultList: [],\n      isloading: false,\n    };\n  },\n  methods: {\n    async init() {\n      await this.doSearch();\n    },\n    clearSearchAdvanceCtx() {\n      this.searchAdvanceCtx = JSON.parse(JSON.stringify(searchAdvanceCtxTemplate));\n    },\n    doRoute(item) {\n      this.$router.push({ name: 'Customer-UserInfo', query: { id: item.id } });\n    },\n    // 搜尋框搜尋\n    doInitSearch(type) {\n      const lastTimeVal = this.submitForm.searchInput;\n      setTimeout(() => {\n        if (lastTimeVal === this.submitForm.searchInput) {\n          this.submitForm.pageOffset = 0;\n          this.doSearch();\n        }\n      }, type ? 0 : 500);\n    },\n    async doSearch() {\n      const submitForm = {\n        // merchantId: this.currentMechantId,\n        keyword: this.submitForm.searchInput,\n        pageOffset: this.submitForm.pageOffset,\n        pageLimit: 20,\n        customerIsCome: this.searchAdvanceCtx.customerIsCome,\n      };\n      if (this.searchAdvanceCtx.year !== '' || this.searchAdvanceCtx.month !== '') {\n        submitForm.birthday = {};\n        submitForm.birthday.year = `${this.searchAdvanceCtx.year}`;\n        submitForm.birthday.month = month.find((item) => item.label === this.searchAdvanceCtx.month) ? month.find((item) => item.label === this.searchAdvanceCtx.month).value : '';\n        submitForm.birthday.day = '';\n      }\n\n      if (this.searchAdvanceCtx.consumptionRange.startDate !== '') {\n        submitForm.consumptionRange = {};\n        submitForm.consumptionRange.startDate = this.searchAdvanceCtx.consumptionRange.startDate;\n        submitForm.consumptionRange.endDate = this.searchAdvanceCtx.consumptionRange.endDate;\n      }\n      if (this.searchAdvanceCtx.baseDateRange.baseDate !== '') {\n        submitForm.baseDateRange = {};\n        submitForm.baseDateRange.baseDate = this.searchAdvanceCtx.baseDateRange.baseDate;\n      }\n      if (this.searchAdvanceCtx.baseDateRange.toDate !== '') {\n        if (submitForm.baseDateRange) {\n          submitForm.baseDateRange.toDate = this.searchAdvanceCtx.baseDateRange.toDate;\n        } else {\n          submitForm.baseDateRange = {};\n          submitForm.baseDateRange.toDate = this.searchAdvanceCtx.baseDateRange.toDate;\n        }\n      }\n      if (this.searchAdvanceCtx.baseDateRange.dayNumber !== '') {\n        if (submitForm.baseDateRange) {\n          submitForm.baseDateRange.dayNumber = Number(this.searchAdvanceCtx.baseDateRange.dayNumber);\n        } else {\n          submitForm.baseDateRange = {};\n          submitForm.baseDateRange.dayNumber = Number(this.searchAdvanceCtx.baseDateRange.dayNumber);\n        }\n      }\n\n      console.log(submitForm);\n      const resp = await this.$api.customersWithoutSorting(submitForm);\n      const { data, errors } = resp.data;\n\n      if (errors) return;\n\n      this.totalPage = Math.ceil(data.customersWithoutSorting.totalCount / 20) - 1;\n      this.submitForm.isEnd = Math.ceil(data.customersWithoutSorting.totalCount / 20) === 1;\n      this.resultList = data.customersWithoutSorting.customers;\n\n      if (this.submitForm.pageOffset < this.totalPage) window.addEventListener('scroll', this.scrollDoSearch);\n      this.isActiveFilter = false;\n    },\n    // 滾動加載\n    async scrollDoSearch() {\n      const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\n      const windowHeight = document.documentElement.clientHeight || document.body.clientHeight;\n      const scrollHeight = document.documentElement.scrollHeight || document.body.scrollHeight;\n\n      if (!this.submitForm.isEnd && !this.isGetting && (scrollTop + windowHeight) >= (scrollHeight - 50)) {\n        this.isGetting = true;\n        this.submitForm.pageOffset += 1;\n\n        if (this.submitForm.pageOffset >= this.totalPage) {\n          this.submitForm.isEnd = true;\n          window.removeEventListener('scroll', this.scrollDoSearch);\n        }\n\n        const submitForm = {\n          merchantId: this.currentMechantId,\n          keyword: this.submitForm.searchInput,\n          pageOffset: this.submitForm.pageOffset,\n          pageLimit: 20,\n        };\n\n        const resp = await this.$api.customers(submitForm);\n        const { data, errors } = resp.data;\n\n        if (errors) return;\n\n        this.isGetting = false;\n        this.resultList = this.resultList.concat(data.customers.customers);\n      }\n    },\n  },\n  computed: {\n    ...mapState('userInfo', ['userInfo', 'currentMechantId']),\n    isReviewResult() {\n      return this.reviewResult.length;\n    },\n    isOrderResult() {\n      return this.orderResult.length;\n    },\n  },\n};\n</script>\n\n<style>\n\n</style>\n","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=c6a8a5a6&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/cli-service/node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","doInitSearch","scopedSlots","_u","key","fn","submitForm","searchInput","$event","_e","proxy","model","value","callback","$$v","$set","expression","isActiveFilter","_l","item","index","doRoute","_v","_s","name","cellphone","birthday","year","month","day","searchAdvanceCtx","clearSearchAdvanceCtx","staticRenderFns","searchAdvanceCtxTemplate","customerIsCome","consumptionRange","startDate","endDate","baseDateRange","baseDate","toDate","dayNumber","description","metaInfo","title","titleTemplate","mounted","beforeDestroy","window","data","pageOffset","isEnd","totalPage","isGetting","resultList","isloading","methods","query","id","setTimeout","type","keyword","pageLimit","console","errors","merchantId","computed","isReviewResult","isOrderResult","component"],"sourceRoot":""}