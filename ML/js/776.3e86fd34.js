"use strict";(self["webpackChunkbos_designer"]=self["webpackChunkbos_designer"]||[]).push([[776],{4776:function(t,e,s){s.r(e),s.d(e,{default:function(){return d}});var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"w-ful box-border  h-full bg-white/80 pb-[84px]"},[s("C-Back-Nav",{attrs:{title:"客戶資料查詢"}}),s("section",{staticClass:"relative z-0 mt-[52px] p-3"},[s("div",{staticClass:"mb-4 flex items-center justify-between"},[s("C-Input",{staticClass:"mb-0 mr-2 w-full",attrs:{placeholder:"搜尋姓名、手機、代號"},on:{input:t.doInitSearch},scopedSlots:t._u([{key:"endIcon",fn:function(){return[""!==t.submitForm.searchInput?s("font-awesome-icon",{staticClass:" text-rose-600",attrs:{icon:"fa-regular fa-xmark"},on:{click:function(e){t.submitForm.searchInput="",t.doInitSearch()}}}):t._e(),s("font-awesome-icon",{attrs:{icon:"fa-regular fa-magnifying-glass"}})]},proxy:!0}]),model:{value:t.submitForm.searchInput,callback:function(e){t.$set(t.submitForm,"searchInput",e)},expression:"submitForm.searchInput"}}),s("font-awesome-icon",{staticClass:"text-2xl",attrs:{icon:"fa-regular fa-filter-list"},on:{click:function(e){t.isActiveFilter=!t.isActiveFilter}}})],1),t._l(t.resultList,(function(e,a){return s("div",{key:"result"+a,staticClass:"mb-4 flex items-center justify-between border-b border-solid border-primary/30",on:{click:function(s){return t.doRoute(e)},keypress:function(s){return t.doRoute(e)}}},[s("div",{staticClass:"w-2/12"},[t._v(t._s(+a+1>9?+a+1:"0"+(+a+1)))]),s("div",{staticClass:"w-2/12 overflow-hidden text-ellipsis whitespace-nowrap"},[t._v(t._s(e.name?e.name:"--"))]),s("div",{staticClass:"w-4/12"},[t._v(t._s(e.cellphone))]),s("div",{staticClass:"w-3/12 text-right"},[e.birthday?s("span",[t._v(" "+t._s(e.birthday.year&&"0"!==e.birthday.year?e.birthday.year+"/":"")+t._s(e.birthday.month&&"0"!==e.birthday.month?e.birthday.month+"/":"--.")+t._s(e.birthday.day&&"0"!==e.birthday.day?e.birthday.day:"--")+" ")]):t._e()]),s("font-awesome-icon",{staticClass:"w-1/12",attrs:{icon:"fa-solid fa-angle-right"}})],1)}))],2),s("C-Filter-Wrap",{attrs:{searchAdvanceCtx:t.searchAdvanceCtx},on:{doFunction:function(e){return t.doInitSearch(!0)},clearFunction:t.clearSearchAdvanceCtx},model:{value:t.isActiveFilter,callback:function(e){t.isActiveFilter=e},expression:"isActiveFilter"}})],1)},i=[],n=s(629),r=s(5399);const o={year:"",month:"",day:"",customerIsCome:null,consumptionRange:{startDate:"",endDate:""},baseDateRange:{baseDate:"",toDate:"",dayNumber:""}};var c={name:"customer-index",description:"客戶資料查詢的首頁",metaInfo:{title:"名留",titleTemplate:"%s | 客戶資料查詢"},mounted(){this.init()},beforeDestroy(){window.removeEventListener("scroll",this.scrollDoSearch)},data(){return{isActiveFilter:!1,submitForm:{searchInput:"",pageOffset:0,isEnd:!1},totalPage:0,isGetting:!1,searchAdvanceCtx:{year:"",month:"",day:"",customerIsCome:null,consumptionRange:{startDate:"",endDate:""},baseDateRange:{baseDate:"",toDate:"",dayNumber:""}},resultList:[],isloading:!1}},methods:{async init(){await this.doSearch()},clearSearchAdvanceCtx(){this.searchAdvanceCtx=JSON.parse(JSON.stringify(o))},doRoute(t){this.$router.push({name:"Customer-UserInfo",query:{id:t.id}})},doInitSearch(t){const e=this.submitForm.searchInput;setTimeout((()=>{e===this.submitForm.searchInput&&(this.submitForm.pageOffset=0,this.doSearch())}),t?0:500)},async doSearch(){const t={keyword:this.submitForm.searchInput,pageOffset:this.submitForm.pageOffset,pageLimit:20,customerIsCome:this.searchAdvanceCtx.customerIsCome};""===this.searchAdvanceCtx.year&&""===this.searchAdvanceCtx.month||(t.birthday={},t.birthday.year=`${this.searchAdvanceCtx.year}`,t.birthday.month=r.Z.find((t=>t.label===this.searchAdvanceCtx.month))?r.Z.find((t=>t.label===this.searchAdvanceCtx.month)).value:"",t.birthday.day=""),""!==this.searchAdvanceCtx.consumptionRange.startDate&&(t.consumptionRange={},t.consumptionRange.startDate=this.searchAdvanceCtx.consumptionRange.startDate,t.consumptionRange.endDate=this.searchAdvanceCtx.consumptionRange.endDate),""!==this.searchAdvanceCtx.baseDateRange.baseDate&&(t.baseDateRange={},t.baseDateRange.baseDate=this.searchAdvanceCtx.baseDateRange.baseDate),""!==this.searchAdvanceCtx.baseDateRange.toDate&&(t.baseDateRange||(t.baseDateRange={}),t.baseDateRange.toDate=this.searchAdvanceCtx.baseDateRange.toDate),""!==this.searchAdvanceCtx.baseDateRange.dayNumber&&(t.baseDateRange||(t.baseDateRange={}),t.baseDateRange.dayNumber=Number(this.searchAdvanceCtx.baseDateRange.dayNumber)),console.log(t);const e=await this.$api.customersWithoutSorting(t),{data:s,errors:a}=e.data;a||(this.totalPage=Math.ceil(s.customersWithoutSorting.totalCount/20)-1,this.submitForm.isEnd=1===Math.ceil(s.customersWithoutSorting.totalCount/20),this.resultList=s.customersWithoutSorting.customers,this.submitForm.pageOffset<this.totalPage&&window.addEventListener("scroll",this.scrollDoSearch),this.isActiveFilter=!1)},async scrollDoSearch(){const t=document.documentElement.scrollTop||document.body.scrollTop,e=document.documentElement.clientHeight||document.body.clientHeight,s=document.documentElement.scrollHeight||document.body.scrollHeight;if(!this.submitForm.isEnd&&!this.isGetting&&t+e>=s-50){this.isGetting=!0,this.submitForm.pageOffset+=1,this.submitForm.pageOffset>=this.totalPage&&(this.submitForm.isEnd=!0,window.removeEventListener("scroll",this.scrollDoSearch));const t={merchantId:this.currentMechantId,keyword:this.submitForm.searchInput,pageOffset:this.submitForm.pageOffset,pageLimit:20},e=await this.$api.customers(t),{data:s,errors:a}=e.data;if(a)return;this.isGetting=!1,this.resultList=this.resultList.concat(s.customers.customers)}}},computed:{...(0,n.rn)("userInfo",["userInfo","currentMechantId"]),isReviewResult(){return this.reviewResult.length},isOrderResult(){return this.orderResult.length}}},h=c,u=s(3736),l=(0,u.Z)(h,a,i,!1,null,null,null),d=l.exports}}]);
//# sourceMappingURL=776.3e86fd34.js.map