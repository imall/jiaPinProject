"use strict";(self["webpackChunkbos_designer"]=self["webpackChunkbos_designer"]||[]).push([[776],{4776:function(e,t,a){a.r(t),a.d(t,{default:function(){return f}});var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("main",{staticClass:"w-ful box-border  h-full bg-white/80 pb-[84px]"},[a("C-Back-Nav",{attrs:{title:"客戶資料查詢"}}),a("section",{staticClass:"relative z-0 mt-[52px] p-3"},[a("div",{staticClass:"mb-4 flex items-center justify-between"},[a("C-Input",{staticClass:"mb-0 mr-2 w-full",attrs:{placeholder:"搜尋姓名、手機、代號"},on:{input:e.doInitSearch},scopedSlots:e._u([{key:"endIcon",fn:function(){return[""!==e.submitForm.searchInput?a("font-awesome-icon",{staticClass:" text-rose-600",attrs:{icon:"fa-regular fa-xmark"},on:{click:function(t){e.submitForm.searchInput="",e.doInitSearch()}}}):e._e(),a("font-awesome-icon",{attrs:{icon:"fa-regular fa-magnifying-glass"}})]},proxy:!0}]),model:{value:e.submitForm.searchInput,callback:function(t){e.$set(e.submitForm,"searchInput",t)},expression:"submitForm.searchInput"}}),a("font-awesome-icon",{staticClass:"text-2xl",attrs:{icon:"fa-regular fa-filter-list"},on:{click:function(t){e.isActiveFilter=!e.isActiveFilter}}})],1),e._l(e.resultList,(function(t,n){return a("div",{key:"result"+n,staticClass:"mb-4 flex items-center justify-between border-b border-solid border-primary/30",on:{click:function(a){return e.doRoute(t)},keypress:function(a){return e.doRoute(t)}}},[a("div",{staticClass:"w-2/12"},[e._v(e._s(+n+1>9?+n+1:"0"+(+n+1)))]),a("div",{staticClass:"w-2/12 overflow-hidden text-ellipsis whitespace-nowrap"},[e._v(e._s(t.name?t.name:"--"))]),a("div",{staticClass:"w-4/12"},[e._v(e._s(t.cellphone))]),a("div",{staticClass:"w-3/12 text-right"},[t.birthday?a("span",[e._v(" "+e._s(t.birthday.year&&"0"!==t.birthday.year?t.birthday.year+"/":"")+e._s(t.birthday.month&&"0"!==t.birthday.month?t.birthday.month+"/":"--.")+e._s(t.birthday.day&&"0"!==t.birthday.day?t.birthday.day:"--")+" ")]):e._e()]),a("font-awesome-icon",{staticClass:"w-1/12",attrs:{icon:"fa-solid fa-angle-right"}})],1)}))],2),a("C-Filter-Wrap",{attrs:{searchAdvanceCtx:e.searchAdvanceCtx},on:{doFunction:function(t){return e.doInitSearch(!0)},clearFunction:e.clearSearchAdvanceCtx},model:{value:e.isActiveFilter,callback:function(t){e.isActiveFilter=t},expression:"isActiveFilter"}})],1)},r=[],s=a(4648),i=a(6835),o=a(8534),c=(a(8862),a(9826),a(1539),a(9653),a(2222),a(629)),u=a(5399),l={year:"",month:"",day:"",customerIsCome:null,consumptionRange:{startDate:"",endDate:""},baseDateRange:{baseDate:"",toDate:"",dayNumber:""}},d={name:"customer-index",description:"客戶資料查詢的首頁",metaInfo:{title:"名留",titleTemplate:"%s | 客戶資料查詢"},mounted:function(){this.init()},beforeDestroy:function(){window.removeEventListener("scroll",this.scrollDoSearch)},data:function(){return{isActiveFilter:!1,submitForm:{searchInput:"",pageOffset:0,isEnd:!1},totalPage:0,isGetting:!1,searchAdvanceCtx:{year:"",month:"",day:"",customerIsCome:null,consumptionRange:{startDate:"",endDate:""},baseDateRange:{baseDate:"",toDate:"",dayNumber:""}},resultList:[],isloading:!1}},methods:{init:function(){var e=this;return(0,o.Z)((0,i.Z)().mark((function t(){return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.doSearch();case 2:case"end":return t.stop()}}),t)})))()},clearSearchAdvanceCtx:function(){this.searchAdvanceCtx=JSON.parse(JSON.stringify(l))},doRoute:function(e){this.$router.push({name:"Customer-UserInfo",query:{id:e.id}})},doInitSearch:function(e){var t=this,a=this.submitForm.searchInput;setTimeout((function(){a===t.submitForm.searchInput&&(t.submitForm.pageOffset=0,t.doSearch())}),e?0:500)},doSearch:function(){var e=this;return(0,o.Z)((0,i.Z)().mark((function t(){var a,n,r,s,o;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={keyword:e.submitForm.searchInput,pageOffset:e.submitForm.pageOffset,pageLimit:20,customerIsCome:e.searchAdvanceCtx.customerIsCome},""===e.searchAdvanceCtx.year&&""===e.searchAdvanceCtx.month||(a.birthday={},a.birthday.year="".concat(e.searchAdvanceCtx.year),a.birthday.month=u.Z.find((function(t){return t.label===e.searchAdvanceCtx.month}))?u.Z.find((function(t){return t.label===e.searchAdvanceCtx.month})).value:"",a.birthday.day=""),""!==e.searchAdvanceCtx.consumptionRange.startDate&&(a.consumptionRange={},a.consumptionRange.startDate=e.searchAdvanceCtx.consumptionRange.startDate,a.consumptionRange.endDate=e.searchAdvanceCtx.consumptionRange.endDate),""!==e.searchAdvanceCtx.baseDateRange.baseDate&&(a.baseDateRange={},a.baseDateRange.baseDate=e.searchAdvanceCtx.baseDateRange.baseDate),""!==e.searchAdvanceCtx.baseDateRange.toDate&&(a.baseDateRange||(a.baseDateRange={}),a.baseDateRange.toDate=e.searchAdvanceCtx.baseDateRange.toDate),""!==e.searchAdvanceCtx.baseDateRange.dayNumber&&(a.baseDateRange||(a.baseDateRange={}),a.baseDateRange.dayNumber=Number(e.searchAdvanceCtx.baseDateRange.dayNumber)),console.log(a),t.next=9,e.$api.customersWithoutSorting(a);case 9:if(n=t.sent,r=n.data,s=r.data,o=r.errors,!o){t.next=13;break}return t.abrupt("return");case 13:e.totalPage=Math.ceil(s.customersWithoutSorting.totalCount/20)-1,e.submitForm.isEnd=1===Math.ceil(s.customersWithoutSorting.totalCount/20),e.resultList=s.customersWithoutSorting.customers,e.submitForm.pageOffset<e.totalPage&&window.addEventListener("scroll",e.scrollDoSearch),e.isActiveFilter=!1;case 18:case"end":return t.stop()}}),t)})))()},scrollDoSearch:function(){var e=this;return(0,o.Z)((0,i.Z)().mark((function t(){var a,n,r,s,o,c,u,l;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=document.documentElement.scrollTop||document.body.scrollTop,n=document.documentElement.clientHeight||document.body.clientHeight,r=document.documentElement.scrollHeight||document.body.scrollHeight,e.submitForm.isEnd||e.isGetting||!(a+n>=r-50)){t.next=16;break}return e.isGetting=!0,e.submitForm.pageOffset+=1,e.submitForm.pageOffset>=e.totalPage&&(e.submitForm.isEnd=!0,window.removeEventListener("scroll",e.scrollDoSearch)),s={merchantId:e.currentMechantId,keyword:e.submitForm.searchInput,pageOffset:e.submitForm.pageOffset,pageLimit:20},t.next=10,e.$api.customers(s);case 10:if(o=t.sent,c=o.data,u=c.data,l=c.errors,!l){t.next=14;break}return t.abrupt("return");case 14:e.isGetting=!1,e.resultList=e.resultList.concat(u.customers.customers);case 16:case"end":return t.stop()}}),t)})))()}},computed:(0,s.Z)((0,s.Z)({},(0,c.rn)("userInfo",["userInfo","currentMechantId"])),{},{isReviewResult:function(){return this.reviewResult.length},isOrderResult:function(){return this.orderResult.length}})},m=d,h=a(3736),b=(0,h.Z)(m,n,r,!1,null,null,null),f=b.exports}}]);
//# sourceMappingURL=776-legacy.c50c2319.js.map